<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>교통 데이터 API 연동 프로토타입</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>교통 데이터 API 프로토타입</h1>
        
        <!-- 섹션 1: 최근 교통 데이터 -->
        <div class="api-section">
            <h2>최근 교통 데이터 조회</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /api/traffic/recent</p>
            <div class="button-group">
                <button onclick="getRecentTraffic()">조회하기</button>
                <input type="number" id="minutes" placeholder="분 (기본: 10)" value="10" min="1" max="60">
                <input type="number" id="limit" placeholder="개수 (기본: 100)" value="100" min="1" max="500">
            </div>
            <div id="recent-status" class="status loading" style="display:none;"></div>
            <div id="recent-response" class="response-box"></div>
        </div>
        
        <!-- 섹션 2: 특정 링크 데이터 -->
        <div class="api-section">
            <h2>특정 링크 ID 데이터 조회</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /api/traffic/link/{link_id}</p>
            <div class="button-group">
                <input type="text" id="linkId" placeholder="링크 ID (예: 101000100)" value="101000100">
                <button onclick="getTrafficByLink()">조회하기</button>
            </div>
            <div id="link-status" class="status loading" style="display:none;"></div>
            <div id="link-response" class="response-box"></div>
        </div>
        
        <!-- 섹션 3: 통계 데이터 -->
        <div class="api-section">
            <h2>링크별 평균 속도 통계</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /api/traffic/stats</p>
            <button onclick="getTrafficStats()">조회하기</button>
            <div id="stats-status" class="status loading" style="display:none;"></div>
            <div id="stats-response" class="response-box"></div>
            <div id="stats-table"></div>
        </div>
        
        <!-- 섹션 4: 헬스 체크 -->
        <div class="api-section">
            <h2>서버 상태 확인</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /health</p>
            <button onclick="getHealth()">확인하기</button>
            <div id="health-status" class="status loading" style="display:none;"></div>
            <div id="health-response" class="response-box"></div>
        </div>

        <!-- 섹션 5: CCTV 스트리밍 -->
        <div class="api-section">
            <h2>실시간 CCTV 모니터링</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /cctv/streams</p>
            <button onclick="loadCCTVStreams()">CCTV 스트림 로드</button>
            <div id="cctv-status" class="status loading" style="display:none;"></div>
            
            <div class="cctv-grid">
                <div class="cctv-box">
                    <h3 id="cctv1-name">CCTV 1</h3>
                    <video id="cctv1" controls muted autoplay playsinline></video>
                </div>
                <div class="cctv-box">
                    <h3 id="cctv2-name">CCTV 2</h3>
                    <video id="cctv2" controls muted autoplay playsinline></video>
                </div>
                <div class="cctv-box">
                    <h3 id="cctv3-name">CCTV 3</h3>
                    <video id="cctv3" controls muted autoplay playsinline></video>
                </div>
                <div class="cctv-box">
                    <h3 id="cctv4-name">CCTV 4</h3>
                    <video id="cctv4" controls muted autoplay playsinline></video>
                </div>
            </div>
        </div>

        <!--섹션 6: 실시간 도시 데이터 (인구현황, LIVE_PPLTN_STTS)-->
        <div class="api-section">
            <h2>실시간 도시 데이터 (인구)</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /city/population/...</p>
            
            <div class="button-group">
                <input type="text" id="areaName" placeholder="지역명 (예: 강남역)" value="강남역">
                <button onclick="getCityPopulationCurrent()">실시간 현황 조회</button>
                <button onclick="getCityPopulationForecast()">인구 예측 조회</button>
            </div>
            
            <h3 style="font-size: var(--font-size-lg); margin-top: var(--space-16);">
                현황 결과 (current)
                <span id="city-current-status" class="status loading" style="display:none;"></span>
            </h3>
            <div id="city-current-response" class="response-box" style="display: none;"></div>

            <h3 style="font-size: var(--font-size-lg); margin-top: var(--space-16);">
                예측 결과 (forecast)
                <span id="city-forecast-status" class="status loading" style="display:none;"></span>
            </h3>
            <div id="city-forecast-response" class="response-box" style="display: none;"></div>
            <div id="city-forecast-table"></div>
        </div>
    
        <!--섹션 7: 실시간 돌발 정보 -->
        <div class="api-section">
            <h2>실시간 돌발 정보 (사고/공사)</h2>
            <p style="margin-bottom: 10px; color: #666;">GET /incident/active (최근 30분 내 갱신된 정보)</p>
            
            <div class="button-group">
                <button onclick="getActiveIncidents()">조회하기</button>
            </div>
            
            <h3 style="font-size: var(--font-size-lg); margin-top: var(--space-16);">
                조회 결과
                <span id="incident-status" class="status loading" style="display:none;"></span>
            </h3>
            
            <div id="incident-response" class="response-box" style="display: none;"></div>
            
            <div id="incident-table"></div>
        </div>
    
    
    
    
    
    </div>

    
    <!-- ------------------------------------------------------- -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="script.js"></script>
    <script>
        // 페이지 로드 즉시 CCTV 스트림 자동 로드
        console.log('=== 자동 로드 스크립트 실행 ===');

        // 여러 방법으로 시도
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMContentLoaded 이벤트 발생');
            setTimeout(function() {
                console.log('CCTV 자동 로드 시작');
                if (typeof loadCCTVStreams === 'function') {
                    loadCCTVStreams();
                } else {
                    console.error('loadCCTVStreams 함수를 찾을 수 없습니다');
                }
            }, 1000);
        });
    </script>
</body>
</html>
